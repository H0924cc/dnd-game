<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D冒险 - 游戏</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #fff;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
        }
        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
        }
        .btn-primary:hover {
            background: linear-gradient(45deg, #ee5a24, #ff6b6b);
        }
        .btn-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            border: none;
        }
        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            border: none;
        }
        .navbar {
            background: rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: blur(10px);
        }
        .game-log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .game-log::-webkit-scrollbar {
            width: 8px;
        }
        .game-log::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        .game-log::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }
        .character-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
        }
        .health-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            height: 20px;
        }
        .health-fill {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            height: 100%;
            transition: width 0.3s ease;
        }
        .action-btn {
            transition: transform 0.2s ease;
        }
        .action-btn:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-dragon me-2"></i>D&D冒险
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">
                            <i class="fas fa-home me-1"></i>首页
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/character/{id}(id=${character.id})}">
                            <i class="fas fa-user me-1"></i>角色详情
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mt-4">
        <div class="row">
            <!-- 游戏日志区域 -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-scroll me-2"></i>冒险日志</h5>
                    </div>
                    <div class="card-body">
                        <div class="game-log" id="gameLog">
                            <div class="text-success">
                                <i class="fas fa-map-marker-alt me-2"></i>
                                你站在一个神秘的洞穴入口前。洞穴深处传来微弱的光芒，似乎隐藏着未知的秘密...
                            </div>
                            <br>
                            <div class="text-info">
                                <i class="fas fa-info-circle me-2"></i>
                                选择你的行动来继续冒险！
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 行动按钮 -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h5><i class="fas fa-dice me-2"></i>选择行动</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-2">
                                <button class="btn btn-primary w-100 action-btn" onclick="explore()">
                                    <i class="fas fa-search me-2"></i>探索洞穴
                                </button>
                            </div>
                            <div class="col-md-6 mb-2">
                                <button class="btn btn-success w-100 action-btn" onclick="rest()">
                                    <i class="fas fa-bed me-2"></i>休息恢复
                                </button>
                            </div>
                            <div class="col-md-6 mb-2">
                                <button class="btn btn-warning w-100 action-btn" onclick="rollDice()">
                                    <i class="fas fa-dice-d20 me-2"></i>投掷骰子
                                </button>
                            </div>
                            <div class="col-md-6 mb-2">
                                <button class="btn btn-outline-light w-100 action-btn" onclick="checkInventory()">
                                    <i class="fas fa-shopping-bag me-2"></i>查看物品
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 角色状态面板 -->
            <div class="col-md-4">
                <div class="character-panel">
                    <div class="text-center mb-3">
                        <i class="" 
                           th:class="${character.characterClass.name() == 'WARRIOR'} ? 'fas fa-shield-alt text-danger' : 
                                     (${character.characterClass.name() == 'MAGE'} ? 'fas fa-hat-wizard text-primary' : 
                                     (${character.characterClass.name() == 'ROGUE'} ? 'fas fa-user-ninja text-success' : 
                                     'fas fa-cross text-warning'))"
                           style="font-size: 3rem;"></i>
                        <h4 th:text="${character.name}">角色名</h4>
                        <p class="text-muted" th:text="${character.characterClass.displayName}">职业</p>
                    </div>
                    
                    <div class="mb-3">
                        <div class="d-flex justify-content-between mb-1">
                            <span><i class="fas fa-heart text-danger me-1"></i>生命值</span>
                            <span th:text="${character.currentHealth + '/' + character.maxHealth}">10/10</span>
                        </div>
                        <div class="health-bar">
                            <div class="health-fill" 
                                 th:style="'width: ' + ${(character.currentHealth * 100 / character.maxHealth)} + '%'"></div>
                        </div>
                    </div>
                    
                    <div class="row text-center mb-3">
                        <div class="col-6">
                            <small class="text-muted">等级</small>
                            <div class="fw-bold" th:text="${character.level}">1</div>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">经验值</small>
                            <div class="fw-bold" th:text="${character.experience}">0</div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <small class="text-muted">护甲等级</small>
                        <div class="fw-bold" th:text="${character.armorClass}">15</div>
                    </div>
                    
                    <div class="d-grid">
                        <a th:href="@{/character/{id}(id=${character.id})}" class="btn btn-outline-light btn-sm">
                            <i class="fas fa-user-cog me-1"></i>角色详情
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="text-center mt-5 mb-3">
        <p class="text-muted">© 2024 D&D文字冒险游戏</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const gameLog = document.getElementById('gameLog');
        
        function addLog(message, type = 'text-light') {
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.innerHTML = `<i class="fas fa-arrow-right me-2"></i>${message}`;
            gameLog.appendChild(logEntry);
            gameLog.scrollTop = gameLog.scrollHeight;
        }
        
        function explore() {
            const results = [
                "你深入洞穴，发现了一个古老的宝箱！",
                "你遇到了一个友好的商人，他愿意与你交易。",
                "你发现了一个神秘的符文，散发着魔法能量。",
                "你听到了远处传来的怪物咆哮声...",
                "你发现了一个隐藏的通道，通向更深的地方。"
            ];
            const result = results[Math.floor(Math.random() * results.length)];
            addLog(result, 'text-success');
        }
        
        function rest() {
            addLog("你找了个安全的地方休息，恢复了部分生命值。", 'text-info');
            addLog("生命值 +2", 'text-success');
        }
        
        function rollDice() {
            const roll = Math.floor(Math.random() * 20) + 1;
            addLog(`你投掷了d20骰子，结果是: ${roll}`, 'text-warning');
            
            if (roll >= 15) {
                addLog("这是一个很好的结果！", 'text-success');
            } else if (roll >= 10) {
                addLog("结果一般。", 'text-info');
            } else {
                addLog("运气不太好...", 'text-danger');
            }
        }
        
        function checkInventory() {
            addLog("你检查了你的物品栏:", 'text-info');
            addLog("• 铁剑 (武器)", 'text-light');
            addLog("• 皮甲 (护甲)", 'text-light');
            addLog("• 治疗药水 (药水)", 'text-light');
        }
    </script>
</body>
</html> 